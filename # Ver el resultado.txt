# Ver el resultado
head(train)
# Definir las coordenadas de Chapinero (ajusta estas coordenadas)
chapinero_lon <- -74.0598
chapinero_lat <- 4.6372

# Calcular la distancia entre cada punto y las coordenadas de Chapinero
train$distance_to_chapinero <- distGeo(coordinates, c(chapinero_lon, chapinero_lat))

# Definir una distancia umbral para considerar que un punto está en Chapinero (ajusta esta distancia según tu criterio)
umbral_distancia <- 1  # por ejemplo, 1 kilómetro

# Asignar la localidad como "Chapinero" si la distancia es menor que el umbral
train$localidad <- ifelse(train$distance_to_chapinero < umbral_distancia, "Chapinero", "Otra Localidad")

# Eliminar la columna de distancia si ya no es necesaria
train <- train %>% select(-distance_to_chapinero)

summary(train$localidad)